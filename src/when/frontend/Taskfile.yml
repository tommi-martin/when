version: '3'

# Frontend tasks are dependent on shadow-cljs file at the root of the project.
tasks:
  run:
    desc: Runs frontend for development
    cmds:
      - npm run dev
    interactive: true

  install:node:
    desc: Install node modules
    sources:
      - ./package.json
      - ./package-lock.json
    generates:
      - ./node_modules/**/*
    cmds:
      - yes | npm install

  build:
    desc: Builds frontend
    sources:
      - ./resources/**/*
      - ./node_modules/**/*
      - ./src/when/frontend/**/*.cljs
      - ./src/when/common/**/*.cljc
    generates:
      - ./target/resources/**/*
    deps: [install:node]
    cmds:
      - npx shadow-cljs release jar

  clean:
    desc: Deletes the files generated by the build command
    cmds:
      - rm -rf target/resources
